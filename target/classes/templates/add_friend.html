<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
	<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>FaceShare</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="Free HTML5 Website Template by freehtml5.co" />
	<meta name="keywords" content="free website templates, free html5, free template, free bootstrap, free website template, html5, css3, mobile first, responsive" />
	<meta name="author" content="freehtml5.co" />
	<!-- Animate.css -->
	<link rel="stylesheet" href="/css/animate.css">
	<!-- Icomoon Icon Fonts-->
	<link rel="stylesheet" href="/css/icomoon.css">
	<!-- Bootstrap  -->
	<link rel="stylesheet" href="/css/bootstrap.css">
	<!-- Flexslider  -->
	<link rel="stylesheet" href="/css/flexslider.css">
	<!-- Theme style  -->
	<link rel="stylesheet" href="/css/style.css">
	<!-- alertify弹窗样式 -->
	<link rel="stylesheet" href="/css/alertify.css">
	<link rel="stylesheet" href="/css/alertify.rtl.css">
	<link rel="stylesheet" href="/css/default.css">
	<style type="text/css">
	/*搜索结果样式*/
	#search_result_table{width:100px;width:200%;}
	#search_result_table tr td{border:rgba(0, 0, 0, 0.1) 2px solid;text-align: center;}
	#search_result_table tr:not(.head_tr):HOVER{background-color: yellow;}
	</style>

	<!-- Modernizr JS -->
	<script src="/js/modernizr-2.6.2.min.js"></script>
	<!-- FOR IE9 below -->
	<!--[if lt IE 9]>
	<script src="js/respond.min.js"></script>
	<![endif]-->

	</head>
	<body>
		
	<div class="fh5co-loader"></div>
	
	<div id="page">
		<nav class="fh5co-nav" role="navigation">
		<div class="top-menu">
			<div class="container">
				<div class="row">
					<div class="col-xs-2">
						<div id="fh5co-logo"><a href="/toIndex">FaceShare<span>.</span></a></div>
					</div>
					<div class="col-xs-10 text-right menu-1">
						<ul>
							<li><a href="/toIndex">主页</a></li>
							<li class="has-dropdown">
								<a href="#">动态</a>
								<ul class="dropdown">
									<li><a href="/toFaceShare">写心情</a></li>
									<li><a href="/toFriendDynamic">好友动态</a></li>
									<li><a href="/toMyDynamic">我的动态</a></li>
								</ul>
							</li>
							<li class="has-dropdown">
								<a href="#">日记</a>
								<ul class="dropdown">
									<li><a href="/toDiary">写日记</a></li>
									<li><a href="/toMyDiary">我的日记</a></li>
								</ul>
							</li>
							<li class="has-dropdown active">
								<a href="#">好友</a>
								<ul class="dropdown">
									<li><a href="/toAddFriend">添加好友</a></li>
									<li><a href="/toMyFriends">我的好友</a></li>
								</ul>
							</li>
							<li class="has-dropdown">
								<a href="#" th:text="${session.normalUser.nickname == null?session.normalUser.username:session.normalUser.nickname}+'，你好！'">用户名</a>
								<ul class="dropdown">
									<li><a href="/toUserMessage" th:text="${session.messageCount==null?'0':session.messageCount}+'条未读信息'"></a></li>
									<li><a href="/toAddUserInfo">个人信息</a></li>
									<li><a href="/loginout">注销</a></li>
								</ul>
							</li>
						</ul>
					</div>
				</div>
			</div>
		</div>
	</nav>

	<div id="fh5co-contact">
		<div class="container">
			<div class="row animate-box">
				<div class="col-md-8 col-md-offset-2 text-center fh5co-heading">
					<p>在下面，检索你希望添加的好友的信息，再点击申请，简单两步，即可成为朋友</p>
				</div>
			</div>
		</div>
		<div class="container">
				<div class="row">
					<form enctype="multipart/form-data" method="post" id="search_form">
						<div class="col-md-7 col-md-offset-3 animate-box">
							<div class="row">
								<div class="col-md-7">
									<div class="form-group">
										<input type="text"  name="nickname" class="form-control" placeholder="昵称">
									</div>
								</div>
								<div class="col-md-7">
									<div class="form-group">
										<input type="text"  name="username" class="form-control" placeholder="用户名">
									</div>
								</div>
								<div class="col-md-7">
									<div class="form-group">
										<input type="text"  name="email" class="form-control" placeholder="电子邮箱">
									</div>
								</div>
								<div class="col-md-10">
									<div class="form-group" style="overflow: auto;border: rgba(0, 0, 0, 0.1) 2px solid;height: 300px;">
										<table id="search_result_table">
											<tr class="head_tr">
												<td>昵称</td>
												<td>简介</td>
												<td>邮箱</td>
												<td>操作</td>
											</tr>
										</table>
									</div>
								</div>
								<div class="col-md-12">
									<div class="form-group">
										<input id="search_user" type="button" value="检索" class="btn btn-primary">
									</div>
								</div>
							</div>
						</div>
					</form>
				</div>
			</div>
	</div>
	
	<div id="fh5co-started">
	</div>

	<footer id="fh5co-footer" role="contentinfo">
		<div class="container">
			<div class="row row-pb-md">
				<div class="col-md-4 fh5co-widget">
					<h4>Air</h4>
					<p>Facilis ipsum reprehenderit nemo molestias. Aut cum mollitia reprehenderit. Eos cumque dicta adipisci architecto culpa amet.</p>
				</div>
				<div class="col-md-2 col-md-push-1 fh5co-widget">
					<h4>Links</h4>
					<ul class="fh5co-footer-links">
						<li><a href="#">Home</a></li>
						<li><a href="#">Portfolio</a></li>
						<li><a href="#">Blog</a></li>
						<li><a href="#">About</a></li>
					</ul>
				</div>

				<div class="col-md-2 col-md-push-1 fh5co-widget">
					<h4>Categories</h4>
					<ul class="fh5co-footer-links">
						<li><a href="#">Landing Page</a></li>
						<li><a href="#">Real Estate</a></li>
						<li><a href="#">Personal</a></li>
						<li><a href="#">Business</a></li>
						<li><a href="#">e-Commerce</a></li>
					</ul>
				</div>

				<div class="col-md-4 col-md-push-1 fh5co-widget">
					<h4>Contact Information</h4>
					<ul class="fh5co-footer-links">
						<li>198 West 21th Street, <br> Suite 721 New York NY 10016</li>
						<li><a href="tel://1234567920">+ 1235 2355 98</a></li>
						<li><a href="mailto:info@yoursite.com">info@yoursite.com</a></li>
						<li><a href="http://#">freehtml5.co</a></li>
					</ul>
				</div>

			</div>

			<div class="row copyright">
				<div class="col-md-12 text-center">
					<p>
						<small class="block">&copy; 2016 Free HTML5. All Rights Reserved.</small> 
						<small class="block">More Templates <a href="http://www.cssmoban.com/" target="_blank" title="模板之家">模板之家</a> - Collect from <a href="http://www.cssmoban.com/" title="网页模板" target="_blank">网页模板</a></small>
					</p>
					<p>
						<ul class="fh5co-social-icons">
							<li><a href="#"><i class="icon-twitter"></i></a></li>
							<li><a href="#"><i class="icon-facebook"></i></a></li>
							<li><a href="#"><i class="icon-linkedin"></i></a></li>
							<li><a href="#"><i class="icon-dribbble"></i></a></li>
						</ul>
					</p>
				</div>
			</div>

		</div>
	</footer>
	</div>

	<div class="gototop js-top">
		<a href="#" class="js-gotop"><i class="icon-arrow-up22"></i></a>
	</div>
	
	<!-- jQuery -->
	<script src="/js/jquery-3.2.1.min.js"></script>
	<!-- jQuery Easing -->
	<script src="/js/jquery.easing.1.3.js"></script>
	<!-- Bootstrap -->
	<script src="/js/bootstrap.min.js"></script>
	<!-- Waypoints -->
	<script src="/js/jquery.waypoints.min.js"></script>
	<!-- Flexslider -->
	<script src="/js/jquery.flexslider-min.js"></script>
	<!--jquery.validate-->
	<script type="text/javascript" src="/js/jquery.validate.min.js" ></script>
	<script src="/js/main.js"></script>
	<!-- alertify弹窗 -->
	<script src="/js/alertify.js"></script>
	<script type="text/javascript">
		//检索按钮点击事件
		$("#search_user").click(function(){

			var nickname = $("input[name='nickname']").val();
			var username = $("input[name='username']").val();
			var email = $("input[name='email']").val();

			if( nickname == "" && username == "" && email == "" ){
				alertify.alert("必须输入检索项");
			}else{

				$.ajax({
			        type:"post",
			        url:"/searchUser",
			        data:$("#search_form").serialize(),
			        scriptCharset: "utf-8",
			        success: function(data){

				        if(data == "[]"){
				        	alertify.alert("查无数据!");
				        }

			        	$("#search_result_table").html("<tr class=\"head_tr\"><td>昵称</td><td>简介</td><td>邮箱</td><td>操作</td></tr>");
			        	var array = eval(data);
			        	for (var i = 0; i < array.length; i++) {

				        	if(array[i].isYourSelf == false){
					        	
					        	var element = "<tr><td class=\"username\">"+array[i].nickname+"</td><td>"+array[i].description+"</td><td>"+array[i].email+"</td><td><a href=\"#\" onclick=\"add_user(this);return false;\">申请好友</a></td></tr>"
								$("#search_result_table").append(element);

				        	}else{
				        		var element = "<tr><td class=\"username\">"+array[i].nickname+"</td><td>"+array[i].description+"</td><td>"+array[i].email+"</td><td><a href=\"\\toAddUserInfo\">查看信息</a></td></tr>"
								$("#search_result_table").append(element);
				        	}
						}
			        },
			        error:function(){
			        	alertify.alert("accept response error!");
			        }
		        });
			}
		});

		function add_user(t){
			
			var accept_user = $(t).parents("tr").find(".username").text();

			$.post({
		        url:"/addFriend",
		        data:{nickname:accept_user}
	        });
			
			alertify.alert("申请好友请求已经发送给 "+accept_user);

		}


	</script>
	</body>
</html>

